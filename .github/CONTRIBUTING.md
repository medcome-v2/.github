<div dir='rtl'>

# &rlm;⚖️ اصول توسعه مدکام

کد نویسی در مدکام قاعده و قانون مخصوص به خودش رو داره.
این قانون ها از نحوه نوشتن پیام برای کامیت و
lint
کردن فایل ها تا شیوه نام گذاری شاخه ها و
merge
کردن اون ها رو شامل میشه.
توی این فایل با هم دیگه این قانون ها رو بررسی می کنیم.

## فهرست

- [شیوه نوشتن](#-شیوه-نوشتن)
  - [شیوه نوشتن commit](#شیوه-نوشتن-commit)
  - [شیوه نام گذاری branch](#شیوه-نام-گذاری-branch)
  - [شیوه نام گذاری tag](#شیوه-نام-گذاری-tag)
  - [شیوه نوشتن issue](#شیوه-نوشتن-issue)
  - [شیوه نوشتن pull request](#شیوه-نوشتن-pull-request)
- [شاخه ها](#-شاخه-ها)
  - [انواع شاخه ها](#انواع-شاخه-ها)
    - &rlm;[feature](#feature)
    - &rlm;[bugfix](#bugfix)
    - &rlm;[hotfix](#hotfix)
    - &rlm;[release](#release)
    - &rlm;[refactor](#refactor)
    - &rlm;[se](#se)
  - [روش merge کردن](#روش-merge-کردن)
- [commit](#-commit)
- [format کردن](#-format-کردن)
- [نمایش خطا ها](#-نمایش-خطا-ها)
- [issue](#-issue)
- [pull request](#-pull-request)

# &rlm;📚 شیوه نوشتن

## شیوه نوشتن commit

مدکام به زبان فارسی اهمیت میده. به خاطر همین
commit
های مدکام به زبان **فارسی** هستند.

> گیت یکم با راست به چپ نوشتن مشکل داره 😑.
> مثلا اگه بنویسیم
> `ایجاد interceptor برای فرمت کردن response`
> گیت، گیت هاب و حتی vscode اون رو به صورت
> `response برای فرمت کردن interceptor ایجاد`
> نشون می دهند 😔.
> خوشبختانه برای حل این مشکل دو تا راه وجود داره 😃.
>
> 1. اصلا به این مشکل فکر نکنید و متن معمولی رو بنویسید فقط هر زمان که زبان keyboard رو تغییر دادید دکمه `Home` رو هم فشار بدهید.
> 2. از [این افزونه](https://marketplace.visualstudio.com/items?itemName=rouhollah-torshizi.rtl-comment-support) استفاده کنید.

سعی کنید این نکات رو هم رعایت کنید

- پیام ها با معنی و مفهوم باشند
- کلی گویی نکنید
- یه جوری بنویسید که خودتون چند ماه بعد بدون دیدن کد و تنها با خواندن متن commit متوجه تغییرات بشید.
- خط اول بیش از 50 کارکتر نشود
- اگه نیاز به توضیح بیش تر هست اون رو در خط های بعدی بنویسید

## شیوه نام گذاری branch

ما برای نام گذاری شاخه ها از استاندارد های
git flow و github flow
استفاده می کنیم. یعنی نام شاخه ها به صورت
`type/name`
هست. منظور از
name
نام شاخه و
type
یکی از مقادیر زیر است

- &rlm;feature
- &rlm;bugfix
- &rlm;hotfix
- &rlm;release
- &rlm;refactor
- &rlm;se

علاوه بر این ها دو شاخه اصلی `develop` و `main` هم وجود دارند.

## شیوه نام گذاری tag

برای شماره گذاری نسخه ها از روش **semantic versioning**
استفاده می شود. در این روش هر نسخه از سه عدد تشکیل شده است. مانند
`v0.0.0`.

معنی این عدد ها به ترتیب از سمت چپ به راست به اینصورت هست

- نسخه های اصلی
- به روز رسانی ها
- به روز رسانی هایی که با هدف رفع مشکلات ایجاد می شوند

## شیوه نوشتن issue

&rlm;issue
ها قالب های از پیش تعیین شده ای دارند. فقط کافیه که نوع اون
رو انتخاب کنی و جا های خالی رو خودت پر کنی. به همین سادگی 🙂.

## شیوه نوشتن pull request

تنها کاری که برای ایجاد
pullrequest
باید انجام داد اینه که شاخه مبدا و مقصد رو انتخاب کنی و
تغییرات انجام شده، مشکلات رفع شده و ... رو
طبق یه قالب از پیش تعیین شده بنویسی.

# &rlm;🌳 شاخه ها

هر repo دو شاخه اصلی
`main` و `develop`
داره. هیچ commit ای نباید روی این دو شاخه زده بشه.
برای هر کار باید یک شاخه جدید از
`develop`
ایجاد و بعد از اتمام
merge
بشه.

در شاخه `main` همیشه باید آخرین نسخه کامل شده قرار داده بشه.
بنابراین نباید نسخه های کامل نشده رو روی این شاخه قرار بدهید.

> برای راحت تر کار کردن با شاخه ها می تونید از افزونه
> [git graph](https://marketplace.visualstudio.com/items?itemName=mhutchie.git-graph)
> استفاده کنید.

![](https://wac-cdn.atlassian.com/dam/jcr:a13c18d6-94f3-4fc4-84fb-2b8f1b2fd339/01%20How%20it%20works.svg)

## انواع شاخه ها

شاخه ها بر اساس نوعشون دسته بندی می شوند.

### &rlm;feature

از این شاخه ها برای ایجاد یک ویژگی جدید استفاده می شود.
این شاخه ها از `develop` ایجاد شده و در انتها با آن
merge می شوند.

![](https://wac-cdn.atlassian.com/dam/jcr:34c86360-8dea-4be4-92f7-6597d4d5bfae/02%20Feature%20branches.svg)

### &rlm;bugfix

اگه بعد از تموم شدن یه ویژگی و قبل از انتشار اون متوجه یه
bug
شدید، از این شاخه برای رفع اون استفاده کنید. این شاخه ها مانند
`feature`، از `develop`
ایجاد و درنهایت با اون merge می شوند.

### &rlm;hotfix

وقتی که تو نسخه منتشر شده یه مشکلی پیدا میشه، مشکل باید
هر چه سریع تر رفع بشه. برای همین از این شاخه ها به جای
`bugfix`
استفاده می کنیم. در واقع این شاخه ها مستقیما از
`main`
ایجاد می شوند و در پایان هم با
`main` و `develop`
ادغام می شوند. با ایجاد هر یک از این شاخه ها عدد سوم شماره
نسخه یکی زیاد می شود.

![](https://wac-cdn.atlassian.com/dam/jcr:cc0b526e-adb7-4d45-874e-9bcea9898b4a/04%20Hotfix%20branches.svg)

### &rlm;release

در هنگام انتشار ممکن است نیاز به تغییرات باشه. برای همین
به جای اینکه شاخه
`develp` مستقیم با `main`
ادغام بشه، از شاخه های
`release` استفاده میشه. این شاخه ها از
`develop` به وجود آمده و پس از اتمام کارشان علاوه بر با
`develop` با `main`
هم ادغام می شوند. این شاخه ها بلافاصله بعد از ادغام حذف
نمی شوند و تا مدتی نگه داشته می شوند تا مطمئن بشوند مشکلی
در این نسخه وجود نداره.

برای نامگذاری این شاخه ها از شماره نسخه استفاده میشه. مثلا
`relese/1.0.2`.
همچنین بعد از ادغام یک
tag جدید ایجاد می شود.

### &rlm;refactor

این شاخه ها دقیقا همانند
`feature`
هستند ولی به جای اینکه ویژگی جدیدی در آن توسعه داده شود،
کد های قبلی باز بینی شده و کیفیتشان بهتر می شود.

### &rlm;se

برای انجام کار هایی که مربوط به کد زدن نیستند و در زمینه اصول
مهندسی نرم افزار، محیط توسعه، ابزار ها و ... هستند از این
شاخه استفاده می شود.

## روش merge کردن

![انواع merge](https://i.stack.imgur.com/IOtpM.png)

برای merge کردن همیشه باید یه
[pull request](#pull-request)
ساخته بشه. هیچ وقت نباید merge به صورت دستی انجام بشه. برای
merge کردن 3 حالت وجود داره.

1. &rlm;**merge commit**: یک commit جدید ایجاد شده و دو شاخه را با هم ادغام می کند.
2. &rlm;**squash**: همه commit ها در قالب یک commit به شاخه اصلی اضافه می شوند.
3. &rlm;**rebase**: در این روش commit ها از شاخه اول به شاخه دوم منتقل می شوند.

![merge types](https://i.stack.imgur.com/hUtiB.png)

ما از روش اول استفاده می کنیم. چون در این حالت ساختار شاخه ها
باقی می مانند ولی در دو حالت دیگه نه. دستور معادل این حالت
`git merge --no-ff` است.

پیامی که برای این commit ها باید نوشته شود دارای سه بخش است.
در خط اول هدف شاخه نوشته می شود.
مثلا **اتمام authentication**.
در خط دوم پیام پیش فرض گیت باقی می ماند. قالب این پیام به صورت
**Merge pull request #n from ... into develop**
است. در خط سوم به بعد لیستی از اقدامات انجام شده نوشته می شود.
مثلا:

<div dir='ltr'>

```
ها import اتمام مرتب کردن
Merge pull request #4 from refactor/import into develop

- ها import مرتب کردن
- util به core انتقال ماژول های غیر اصلی از پوشه
- user schema در export اصلاح شیوه
```

</div>

# &rlm;🏁 commit

قبل از انجام هر commit ابتدا فایل های stage شده مرتب و سپس lint
می شوند و اگر مشکلی نبود commit انجام می شود.
تمامی این فرایند ها به صورت خودکار و به کمک
husky ،git hook و lint-staged
انجام می شوند. به دلیل انجام این بررسی ها مدت زمان هر
commit
چندین ثانیه افزایش پیدا کرده است.

حسابی که برای commit کردن استفاده می شود باید دو نکته را رعایت کند.
اولا نام شخص به صورت فارسی و کامل باشد و دوما با استفاده از
GPG
تایید شود.

> برای تعیین نام و ایمیل از این دستور استفاده کنید.
>
> <div dir='ltr'>
>
> ```sh
> git config --global user.name "نام"
> git config --global user.email "ایمیل"
> ```
>
> </div>
>
> اگر از
> `global--`
> استفاده نشود به جای همه
> repository
> ها، نام و ایمیل جدید تنها برای
> repository
> فعلی در نظر گرفته می شود.

> برای استفاده از GPG
> [این راهنما](https://docs.github.com/en/authentication/managing-commit-signature-verification/about-commit-signature-verification)
> را بخوانید.

# &rlm;✨ format کردن

برای منظم نگه داشتن کد ها باید آن ها را
format
کرد. ما برای این کار از
prettier
استفاده می کنیم.

> برای اینکه کد ها هنگام ذخیره شدن به صورت
> خودکار فرمت شود، از
> [افزونه prettier](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode)
> استفاده کنید.

# &rlm;🚨 نمایش خطا ها

برای بررسی کیفیت کد ها از
eslint
استفاده می کنیم. نحوه کد زنی باید به گونه ای
باشد که هیچ خطایی نداشته باشد.

> برای نمایش خطا ها در vscode
> [افزونه eslint](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint)
> را نصب کنید.

# &rlm;📄 issue

ما از issue ها برای مدیریت پروژه و هماهنگی کار ها استفاده
می کنیم. بعد از اینکه issue
طبق یکی از قالب های از پیش تعیین شده ایجاد شد، به صورت خودکار
label
زده می شود. سپس isuue یک نفر باید مسئول آن بشود.
برای این کار از قسمت assignee یک نفر انتخاب می شود.
سپس کار روی issue شروع می شود و لیست اقداماتی که در issue
مشخص شده به ترتیب انجام می شود. در نهایت pull request
ایجاد و issue به آن متصل می شود. با merge شدن
pull request به طور خودکار issue بسته می شود.

# &rlm;🚩 pull request

هر pull request باید توضیحاتی در مورد امکانات جدید، مشکلات
برطرف شده و مشکلات موجود داشته باشد. بعد از ایجاد pull request
باید آن را به issue مرتبط متصل کنیم.

</div>
